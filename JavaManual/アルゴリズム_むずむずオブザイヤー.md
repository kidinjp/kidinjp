* [ユークリッドの互除法メニュー](#ユークリッドの互除法メニュー)
  * [RSA暗号の作成](#rsa暗号の作成)

## ユークリッドの互除法メニュー
[paiza](#https://paiza.jp/works/mondai/euclidean_primer/problem_index?language_uid=java)

### RSA暗号の作成
```Java
import java.util.*;
import java.math.BigInteger;

public class Main {
    // gcd拡張ユークリッドの互除法
    public static BigInteger[] gcd(BigInteger a, BigInteger b) {
        if (b.equals(BigInteger.ZERO)) return new BigInteger[]{a, BigInteger.ONE, BigInteger.ZERO};

        BigInteger[] result = gcd(b, a.mod(b));
        return new BigInteger[]{
            result[0],
            result[2],
            result[1].subtract(a.divide(b).multiply(result[2]))
        };
    }

    // 高速な累乗の計算 (モジュラー指数法)
    public static BigInteger ruijyou(BigInteger a, BigInteger b, BigInteger M) {
        BigInteger result = BigInteger.ONE;
        a = a.mod(M);
        while (b.compareTo(BigInteger.ZERO) > 0) {
            if (b.and(BigInteger.ONE).equals(BigInteger.ONE)) {
                result = result.multiply(a).mod(M);
            }
            a = a.multiply(a).mod(M);
            b = b.shiftRight(1);
        }
        return result;
    }

    // 素因数分解: 最初の2つの素因数を返す
    public static BigInteger[] factorize(BigInteger n) {
        List<BigInteger> factors = new ArrayList<>();
        BigInteger two = BigInteger.valueOf(2);

        while (n.mod(two).equals(BigInteger.ZERO)) {
            factors.add(two);
            n = n.divide(two);
        }

        BigInteger i = BigInteger.valueOf(3);
        BigInteger sqrtN = n.sqrt().add(BigInteger.ONE);
        while (i.compareTo(sqrtN) <= 0) {
            while (n.mod(i).equals(BigInteger.ZERO)) {
                factors.add(i);
                n = n.divide(i);
            }
            i = i.add(BigInteger.TWO);
        }

        if (n.compareTo(BigInteger.ONE) > 0) factors.add(n);

        return new BigInteger[]{factors.get(0), factors.get(1)};
    }

    // 21ビットごとに分割して文字列にデコード
    public static String decodeNumber(BigInteger M) {
        StringBuilder sb = new StringBuilder();
        for (int i = 0; i < 4; i++) {
            BigInteger digit = M.shiftRight(21 - i * 7).and(BigInteger.valueOf(0x7F));
            if (!digit.equals(BigInteger.ZERO)) {
                sb.append((char) digit.intValue());
            }
        }
        return sb.toString();
    }

    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);
        // 素因数分解
        BigInteger p = BigInteger.valueOf(63113);
        BigInteger q = BigInteger.valueOf(63311);
        BigInteger n = p.multiply(q);
        BigInteger n2 = (p.subtract(BigInteger.ONE)).multiply(q.subtract(BigInteger.ONE));
        BigInteger e = BigInteger.valueOf(3007);
        BigInteger M = BigInteger.valueOf(168846554);
        BigInteger E = ruijyou(M, e, n);

        BigInteger[] cxy = gcd(e, n2);
        BigInteger d = cxy[1].mod(n2);
        System.out.println(n + " " + e + " " + E);
        System.out.println(decodeNumber(M));
    }
}
```
