概要
* [データベースとは](#データベースとは)
* [MySQLとは](#mysqlとは)
* [MySQLの基本操作](#mysqlの基本操作)
  * [データベースに接続](#データベースに接続)
  * [データベースを選択](#データベースを選択)
  * [テーブル一覧を表示](#テーブル一覧を表示)
  * [データベース一覧を表示](#データベース一覧を表示)
  * [テーブルの定義を確認する](#テーブルの定義を確認する)
  * [データベースの作成](#データベースの作成)
  * [テーブルの作成](#テーブルの作成)
  * [テーブルごとを消す](#テーブルごとを消す)
  * [ソース引用](#ソース引用)
  * [終了](#終了)
* [基本構文](#基本構文)
  * [文](#文)
    * [SELECT文、レコードの取得](#select文レコードの取得)
    * [INSERT文、レコードの追加](#insert文レコードの追加)
      * [レコードの単純追加](#レコードの単純追加)
      * [レコードの複数追加](#レコードの複数追加)
      * [オートインクリメント](#オートインクリメント)
    * [UPDATE文、フィールドの更新](#update文フィールドの更新)
      * [フィールドの値を増減させる](#フィールドの値を増減させる)
    * [DELETE文、レコードの削除](#delete文レコードの削除)
    * [TRUNCATE文、すべてのレコードを削除](#truncate文すべてのレコードを削除)
    * [CREATE文、テーブルの作成](#create文テーブルの作成)
      * [データ型](#データ型)
      * [制約](#制約)
        * [FOREIGN KEY、外部キー制約](#foreign-key外部キー制約)
        * [複数列の主キー（Composite Primary Key）](#複数列の主キーcomposite-primary-key)
  * [句](#句)
    * [ORDER BY句、レコードを並び替える](#order-by句レコードを並び替える)
    * [LIMIT句、取得する行数を決める](#limit句取得する行数を決める)
    * [WHERE句、条件を付けてレコードを取得](#where句条件を付けてレコードを取得)
  * [比較演算子](#比較演算子)
    * [IS NULL](#is-null)
    * [IS NOT NULL](#is-not-null)
    * [BETWEEN](#between)
    * [IN](#in)
  * [論理演算子](#論理演算子)
  * [LIKE演算子](#like演算子)
    * [`%` （ワイルドカード）](#ワイルドカード)
    * [`_`（アンダースコア）](#アンダースコア)
    * [`\` （バックスラッシュ）](#バックスラッシュ)
    * [`[]`（角括弧）](#角括弧)
    * [`[^]`（キャレット）](#キャレット)
  * [GROUP BY句、レコードをグループ化する](#group-by句レコードをグループ化する)
  * [集約関数](#集約関数)
    * [SUM()、合計](#sum合計)
    * [AVG()、平均](#avg平均)
    * [MAX()、最大値](#max最大値)
    * [MIN()、最小値](#min最小値)
    * [COUNT()、レコードの出現回数](#countレコードの出現回数)
  * [HAVING句、結果を絞り込む](#having句結果を絞り込む)
  * [結合](#結合)
    * [INNER JOIN句、内部結合](#inner-join句内部結合)
    * [OUTER JOIN句、外部結合](#outer-join句外部結合)
      * [ LEFT OUTER JOIN句、左外部結合](#left-outer-join句左外部結合)
      * [ RIGHT OUTER JOIN句、右外部結合](#right-outer-join句右外部結合)
      * [ FULL OUTER JOIN句、完全外部結合](#full-outer-join句完全外部結合)

***************************************************************************
## データベースとは
* データベース(DB)
  * 大量のデータを効率よく取り出せるように加工されたデータの集まり
* データベースマネジメントシステム（DBMS）
  * Database Managment System
  * データベースを管理するためのソフトウェア
* データベースの種類
  * リレーショナルデータベース　⇒　一番よく使われる
    * リレーション（関係性）を基盤にデータを整理するデータベース形式
    * テーブルとの表で管理する
  * Key-Valueストア
  * ドキュメントデータベース
  * グラフデータベース

## MySQLとは
* SQL:構造化照会言語。データベースに対して操作を行うために使用する**問い合わせ言語**
* MySQLは、リレーショナルデータベースマネジメントシステム（RDBMS）の一種（他にはPostgreSQL、Oracle、SQL Serverなど）
* データを行（レコード）と列（カラム）でフィールドなどのデータをテーブル形式で管理し、SQL（Structured Query Language）を使って操作する
* 軽量かつ高速で、Webアプリケーション（WordPress、e-commerceなど）でよく利用される

***************************************************************************
## MySQLの基本操作
### データベースに接続
```bash
mysql -u [ユーザー名] -p

mysql -u root -- paizaでの演習環境はこのようにログインする
```
*  `[ユーザー名]`: ログインするユーザー名
*  パスワードを入力すると接続完了

### データベースを選択
```MySQL
USE データベース名;
```

### テーブル一覧を表示
```MySQL
SHOW TABLES;
```

### データベース一覧を表示
```MySQL
SHOW DATABASES;
```

### テーブルの定義を確認する
```MySQL
DESCRIBE table_name;
```

### データベースの作成
```MySQL
CREATE DATABASE データベース名;
```

### テーブルの作成
```MySQL
CREATE TABLE テーブル名 (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    age INT
);
```

### テーブルごとを消す
DROP TABLE `テーブル名`;

### ソース引用
```MySQL
mysql> source /home/ubuntu/sakila-schema.sql; -- paizaでの演習環境例。復元した際も利用する
```

### 終了
```MySQL
exit
```

***************************************************************************
## 基本構文
コーディングスタイル:
* 読み込み的に大文字小文字に違いはない
* 慣例的に、SQLの文法で決められている単語を大文字
* テーブル名/カラム名など一般的には小文字が用いられる

よく使う概念
* `*`: 全選択
* `--`: 行末までコメントアウト
* `NULL`: `空欄`/ `なにも入っていない`と捉える
* `AS`: カラムに名前を付ける【SELECT name AS 名前】(※ ''などはいらない)
* エイリアス: SELECT A.カラム名 FROM `テーブルA A`;　のように、簡潔にテーブルを指定することができる

### 文
* Statement
* 文全体を構成する**命令**の単位
* データベースに対する操作や要求を意味し、SQL文として実行されるもの  
* 文は「1つの命令を実行する単位」であり、最後に**セミコロン (;)** を付けて終了する
* 主に以下の種類がある：
  * SELECT文: データを取得する
  * INSERT文: データを挿入する
  * UPDATE文: データを更新する
  * DELETE文: データを削除する

```MySQL
SELECT * FROM users ORDER BY age;
```
これは一つの【文】となる  

#### SELECT文、レコードの取得 
SELECT `カラム名` FROM `テーブル名`;  
※ 全カラムを選択したい場合は`*`を記述する  
※ 複数のカラムを選択したい場合は`, `で区切る

#### INSERT文、レコードの追加
##### レコードの単純追加
INSERT INTO `テーブル名`(カラム名) VALUES("値");  
⇒ 指定したテーブルに"値"というデータを持つレコードを追加する

```MySQL
INSERT INTO テーブル名 (カラム名C, カラム名A, カラム名B) VALUES (1, 2, 3); -- 指定した順に追加する
INSERT INTO テーブル名 VALUES (1, 2, 3); -- カラムを指定しなかった場合、左から順に追加する
```
この場合、テーブルの追加結果は以下通りとなる  
| カラム名A | カラム名B | カラム名C |
| --- | --- | --- |
| 2 | 3 | 1 |
| 1 | 2 | 3 |

##### レコードの複数追加
```MySQL
INSERT INTO テーブル名 (カラム名A, カラム名B, カラム名C)
VALUES (1, 2, 3),
(4, 5, 6),
(7, 8, 9); 
```
この場合、テーブルの追加結果は以下通りとなる  
| カラム名A | カラム名B | カラム名C |
| --- | --- | --- |
| 1 | 2 | 3 |
| 4 | 5 | 6 |
| 7 | 8 | 9 |

##### オートインクリメント
AUTO_INCREMENT（INT 型のカラム）  
カラムがオートインクリメントの場合、追加時指定しなくても既有最大値+1を付ける  

```MySQL
INSERT INTO テーブル名 (カラム名B, カラム名C) VALUES ('オートインクリメント', 'テスト');
```
この場合、テーブルの追加結果は以下のようなものになる  
| カラム名A | カラム名B | カラム名C |
| --- | --- | --- |
| 1 | 既有内容 | 既有内容 |
| 2 | オートインクリメント | テスト |

#### UPDATE文、フィールドの更新
UPDATE `テーブル名` SET `カラム名A` = `新しい値A`, `カラム名B` = `新しい値B`, ...  
WHERE `対象カラム名` = `条件`;  
⇒ 指定したテーブルに、`対象カラム名`の内容が条件に合致した場合、  
`カラム名A`の内容を"新しい値A"に、`カラム名B`の内容を"新しい値B"にアップデートする  

* WHEREを掛けない場合、該カラムの全内容に対してアップデートを行う  
* 合致した内容がなかった場合、何も行わない
* カラムが日付や時間の場合、【INTERVAL 1 YEAR】の書き方をする
  * INTERVAL '3:30' HOUR_MINUTE
  * YEAR、MONTH、DAY、HOUR、MINUTE、SECOND 

##### フィールドの値を増減させる
```MySQL
UPDATE テーブル名 SET カラム名 = カラム名 + 5
WHERE 対象カラム名 = 条件;

UPDATE list SET num = num + 10
WHERE TIME(datetime) < "05:00:00";
```

#### DELETE文、レコードの削除
DELETE FROM `テーブル名`  
WHERE `対象カラム名` = `条件`;  

* WHEREを掛けない場合、指定したテーブルのすべてのレコードを削除する

#### TRUNCATE文、すべてのレコードを削除
TRUNCATE TABLE `テーブル名`;  

* DELETE文はレコード一個ずつ消していくが、TRUNCATE文は丸ごと削除し、再び作成する処理を行う
* DELETE: トランザクションが可能で、WHERE条件を使って特定のレコードを削除できる
* TRUNCATE(切り捨て): トランザクション不可で、テーブル内のすべてのデータを削除し、高速に処理される
* 比較的に動作が早い

#### CREATE文、テーブルの作成
CREATE TABLE `テーブル名`(  
  `カラム名A` `データ型` \[`制約（省略可、複数可）`\],  
  `カラム名B` `データ型` \[`制約（省略可、複数可）`\],  
  ...  
);  
⇒ player_idカラムとnameカラムを持つplayersテーブルを作成する  

```MySQL
CREATE TABLE テーブル名(
  カラム名A INTEGER PRIMARY KEY,  -- 整数型
  カラム名B DATE UNIQUE NOT NULL, -- 日付
  カラム名C VARCHAR(8) NOT NULL,  -- 文字列
  カラム名D DECIMAL(3,1),         -- 小数
  カラム名E TEXT                  -- 文字列
);
```

##### データ型
数値データ型  
| データ型 | 用途 | 備考 |
| --- | --- | --- |
| `TINYINT` | 小さな整数<br>-128 ～ 127 | 1バイト使用<br>符号なしで 0 ～ 255 |
| `SMALLINT` | 中くらいの整数<br>-32,768 ～ 32,767 | 2バイト使用<br>符号なしで 0 ～ 65,535 |
| `INTEGER`／<br>`INT` | 標準的な整数<br>-2,147,483,648 ～<br> 2,147,483,647 | 4バイト使用<br>符号なしで 0 ～ 約42億<br>バージョンによっては0.5を四捨五入か切り捨てされる |
| `BIGINT` | 大きな整数<br>-9,223,372,036,854,775,808 ～<br> 9,223,372,036,854,775,807 | 8バイト使用<br>符号なしで 0 ～ 約1.8×10¹⁹ |
| `DECIMAL(M, D)` | 精度を指定した小数 | 固定小数点<br>M は全体の桁数、<br>D は小数点以下の桁数<br>例：(3, 1)は-99.9 ～ 99.9<br>桁数がMを超えた場合エラー<br>小数点がDより多い場合四捨五入される |
| `FLOAT` | 単精度浮動小数点数 | 4バイト使用<br>約7桁の精度 |
| `DOUBLE` | 倍精度浮動小数点数 | 8バイト使用<br>約15桁の精度 |

文字列データ型  
| データ型 | 用途 | 備考 |
| --- | --- | --- |
| `CHAR(M)` | 固定長文字列 | M は文字数（0～255）<br>空白で埋められる |
| `VARCHAR(M)` | 可変長文字列 |  M は最大文字数（1～65,535）|
| `TEXT` | 大量のテキストデータ | 最大 65,535 バイト。インデックスに制限あり |
| `TINYTEXT` | 短いテキスト | 最大 255 バイト |
| `MEDIUMTEXT` | 中程度の長さのテキスト | 最大 16,777,215 バイト |
| `LONGTEXT` | 非常に長いテキスト | 最大 4,294,967,295 バイト |

日付・時刻データ型
| データ型 | 用途 | 備考 |
| --- | --- | --- |
| `DATE` | 日付（YYYY-MM-DD） | 範囲は 1000-01-01 ～ 9999-12-31 |
| `DATETIME` | 日時（YYYY-MM-DD HH:MM:SS） | 精度の高い日時<br>範囲は 1000-01-01 ～ 9999-12-31 |
| `TIMESTAMP` | UNIXタイムスタンプ<br>タイムゾーン対応 | 範囲は 1970-01-01 ～ 2038-01-19 |
| `TIME` | 時間（HH:MM:SS） | 範囲は -838:59:59 ～ 838:59:59 |
| `YEAR` | 年（YYYY） | 範囲は 1901 ～ 2155 |

DATEやDATETIMEについて:  
* 2020-02-02 12:59:00（完全なフォーマット）は有効
* 2020-02-02（日付のみ）は有効　⇒　2020-02-02 00:00:00
* 2020-02（年月のみ）は有効　⇒　2020-02-01 00:00:00  

その他のデータ型
| データ型 | 用途 | 備考 |
| --- | --- | --- |
| `BOOLEAN`| 論理値 | 1＝TRUE<br>0＝FALSE |
| `BLOB` | バイナリデータ<br>（Binary Large Object） | 画像やファイルなどのバイナリデータを格納 |
| `ENUM` | 列挙型 | 定義された値の中から選択 |
| `SET` | 複数値の組み合わせ | 定義された値の中から複数を選択可能 |

##### 制約
| 制約 | 用途 | 備考 |
| --- | --- | --- |
| `DEFAULT` | デフォルト値 | カラムにデータが挿入されない場合、指定されたデフォルト値が使用される<br>例: DEFAULT '晴れ' |
| `NOT NULL` | 非NULL制約 | カラムに NULL の値を挿入できないようにする |
| `UNIQUE` | 一意制約 | カラム内の値が重複しないように制約<br>※ NULLは重複できる |
| `UNIQUE NOT NULL` | 一意制約 +<br> 非NULL制約 | カラム内の値が重複せず、<br>かつ NULL が許容されない<br>※ 複合的に制約を適用 |
| `AUTO_INCREMENT` | オートインクリメント<br>自動採番 | 主に主キー列に使用され、データが挿入されるたびに自動的に連番を生成<br>- 使用例: IDカラム<br>- 1つのテーブルで**1つの列にのみ**設定可能 |
| `CHECK` | チェック制約 | カラムに許容される値を条件式で制約<br>※ MySQL では制約が無視される場合もあるため注意<br>例: CHECK (age >= 18)<br>※ 挿入内容が条件に満たしていなかった場合エラーとなり挿入失敗となる |
| `PRIMARY KEY` | 主キー制約:一意性（重複しない） | 主キー（テーブル内で一意の識別子）を設定する<br>- 自動でインデックスが作成される<br>- **NULL は許容されない**<br>- **1つのテーブルに1つだけ**設定可能<br>- 複数の列で主キーを構成することも可能（複合主キー） |
| `FOREIGN KEY` | 外部キー制約 | 他テーブルの特定のカラム（親テーブル）を参照する制約<br>- 参照整合性を保つ<br>- 例: 子テーブルに存在する値は**必ず親テーブルに存在する必要がある** |

書き方参考：
```MySQL
CREATE TABLE 制約テーブル (
  カラムA INT DEFAULT 0,         -- デフォルト値（DEFAULT）
  カラムB INT NOT NULL,          -- 非NULL制約（NOT NULL）
  カラムC INT UNIQUE,            -- 一意制約（UNIQUE）
  カラムD INT UNIQUE NOT NULL,   -- 一意制約 + 非NULL制約
  カラムE INT AUTO_INCREMENT,    -- 自動採番（AUTO_INCREMENT）
  カラムF INT CHECK (カラムF > 0), -- チェック制約（CHECK）
  PRIMARY KEY (カラムE),          -- 主キー制約（PRIMARY KEY）
  FOREIGN KEY (カラムG) REFERENCES 参照先テーブル名(参照先カラム名) -- 外部キー制約
);

INSERT INTO 制約テーブル (カラムB, カラムC, カラムD, カラムF)
VALUES 
  (100, 1, 10, 5),  -- 正常なデータ (0, 100, 1, 10, 1, 5)
  (200, 2, 20, 10), -- 正常なデータ (0, 200, 2, 20, 2, 10)
  (300, 1, 30, -5); -- エラー (CHECK制約違反: カラムFが0以下)

```

###### FOREIGN KEY、外部キー制約
参照先テーブルの特定カラムに存在する値に限る  
FOREIGN KEY (本テーブルのカラム名) REFERENCES 参照先テーブル名(参照先カラム名)

```MySQL
CREATE TABLE post(
  thread_id INT,
  FOREIGN KEY (thread_id) REFERENCES thread(thread_id)
  );
```
※どっちのカラム名でも（）は必要

###### 複数列の主キー（Composite Primary Key）
この組み合わせがユニークであることで、同じ学生が同じクラブに複数回登録することを防げる
```MySQL
CREATE TABLE club_memberships (
    student_id INT,
    club_id INT,
    join_date DATE,
    PRIMARY KEY (student_id, club_id)
);
```

### 句
* Clause
* 文の中に含まれる部分的な構成要素を指す
* 文を構成する補助的な要素で、それぞれ特定の目的や役割を持っている
* 主に以下の種類がある：
  * WHERE句
  * ORDER BY句
  * GROUP BY句
  * FROM句
```MySQL
SELECT name, age
FROM users
WHERE age > 20
ORDER BY age DESC;
```
SELECT文　⇒　FROM句　⇒　WHERE句　⇒　ORDER BY句

#### ORDER BY句、レコードを並び替える
ORDER BY　`カラム名`; ⇒ 昇順  
ORDER BY　`カラム名`　DESC; ⇒ 降順  

複数の注文も可能(カラムA降順 ⇒ カラムB昇順):
```MySQL
SELECT * FROM テーブル名
film ORDER BY カラムA DESC, カラムB;
```
⇒ 指定したテーブルをカラムA降順にしてから、カラムB昇順にした内容を取得

#### LIMIT句、取得する行数を決める
LIMIT 行数
```MySQL
SELECT * FROM テーブル名
ORDER BY カラム DESC LIMIT 10;
```
⇒ 指定したテーブルをカラムA降順にしてから、上記10テーブルの内容を取得  

なお、環境によっては書き方が違ってくる可能性がある  
`SQL Server`:
```SQL
SELECT TOP 10 * FROM テーブル名
ORDER BY カラム DESC;
```

`Oracle Database`: 
```Oracle
SELECT * FROM テーブル名
ORDER BY カラム DESC FETCH FIRST 10 ROWS ONLY;
```

#### WHERE句、条件を付けてレコードを取得
WHERE 条件
```MySQL
SELECT * FROM テーブル名
WHERE カラム名 >= 20;
```
⇒ 指定したテーブルの中で、カラムの内容が>=20のもののみを取得  
なお、集約関数を使用できない

### 比較演算子
| 演算子 | 意味 |
| --- | --- |
| `=`  | `左辺`と`右辺`が　`等しい` |
| `>`  | `左辺`と`右辺`より`大きい` |
| `>=` | `左辺`と`右辺`　　`以上` |
| `<`  | `左辺`と`右辺`より`小さい` |
| `<=` | `左辺`と`右辺`　　`以下` |
| `<>` | `左辺`と`右辺`が　`異なる` |

#### IS NULL
NULLである場合、それに対して操作する
```MySQL
SELECT * FROM テーブル名
WHERER カラム名 IS NULL;
```

#### IS NOT NULL
NULLではない場合、それに対して操作する
```MySQL
SELECT * FROM テーブル名
WHERER カラム名 IS NOT NULL;
```

#### BETWEEN
BETWEEN 開始値 AND 終了値(小さい順から、日付だと終了値は含まれていない)  

数字でのBETWEEN:
```MySQL
BETWEEN 100 AND 200 -- 200含む
```

日付でのBETWEEN:
```MySQL
BETWEEN '2000-01-01' AND '2000-12-31' -- 2000/12/31 00:00:00 も含まない 
```

#### IN
`カラム名` (NOT) IN ()
```MySQL
SELECT * FROM テーブル名
WHERE カラム名 NOT IN ('A', 'B', 'C');
```
⇒ 指定したテーブルの中で、カラムの内容は(AまたはBまたはC)ではないもののみを取得  

なお、サブクエリで使用することも可能
```MySQL
-- departments テーブルから location = 'New York' の部門を取得し、その部門に属する employees の名前を取得する
SELECT name　FROM employees
WHERE department IN (
    SELECT department
    FROM departments
    WHERE location = 'New York'
);
```

### 論理演算子
* AND
* OR
* NOT
  * NOT (rating = 'A' OR rating IS NULL);

### LIKE演算子
WHERE `カラム名` LIKE 'ABC' ⇒ パターンマッチング用の演算子  

#### `%` （ワイルドカード）
指定した別文字に当たるまで、該方向の内容は何があっても選択される  
WHERE `カラム名` LIKE 'ABC%' ⇒ 前方一致  
WHERE `カラム名` LIKE '%ABC%' ⇒ 後方一致  
WHERE `カラム名` LIKE '%ABC%' ⇒ 部分一致  
なお、%は何回使ってもいい(%A%B%C%)⇒(..AB..C....D...)みたいな結果も可となる  

#### `_`（アンダースコア）
任意の1文字に一致する  
WHERE カラム名 LIKE '_ABC%' ⇒任意の1文字 + ABC  
なお、必ず1文字あるため［ABC］はなし

#### `\` （バックスラッシュ）
エスケープ文字。ESCAPEでエスケープ文字として使用する文字を指定する  
WHERE カラム名 LIKE 'ABC\%' ESCAPE '\'  
⇒【ABC%】との文字列を検索対象とする

#### `[]`（角括弧）
WHERE `カラム名` LIKE '\[AB\]C'  
⇒[]内の対象任意　⇒　AB または AC

WHERE `カラム名` LIKE '\[A-C]'  
⇒　A または B または C


#### `[^]`（キャレット）
WHERE `カラム名` LIKE '\[^AB\]C'  
⇒ \[^\] の中に指定された文字以外にマッチ ⇒ DCなど 

### GROUP BY句、レコードをグループ化する
GROUP BY 集約キー  
※ なお、GROUP BY を使う際、SELECTに書ける要素は【集約キー、集約関数、定数】の3種類のみ  
※ 集約キーではないカラム名を指定するとエラーとなる  

```MySQL
SELECT title, COUNT(*) FROM book -- ここでのCOUNT(*)は集約関数
GROUP BY title;
```
⇒ タイトルカラム+タイトルカラムに現れたしたやつの出現回数  
GROUP BY が指定した集約キーを基準にそれごとに計算

### 集約関数
#### SUM()、合計
指定した列の合計を計算する  
SUM(`カラム名`)

#### AVG()、平均
指定した列の平均値を計算する  
AVG(`カラム名`)

#### MAX()、最大値
指定した列の最大値を取得する  
MAX(`カラム名`)

#### MIN()、最小値
指定した列の最小値を取得する  
MIN(`カラム名`)

#### COUNT()、レコードの出現回数
行数をカウントする（レコードの数を返す）  
COUNT(`カラム名`)

### HAVING句、結果を絞り込む
グループ化したやつに対する絞り込む  
なお、WHEREには集約関数が使えない
```MySQL
SELECT name AS 名前, SUM(price) AS 総価格
FROM member
WHERE payment BETWEEN '2005-01-01' AND '2007-12-31'
GROUP BY 名前
HAVING 総価格 > 100;
```

### 結合
* リレーションを使って、複数のテーブルから1つのテーブルを作ること
* 内部結合
* 外部結合
  * 左外部結合(LEFT OUTER JOIN)
  * 右外部結合(RIGHT OUTER JOIN)
  * 完全外部結合(FULL OUTER JOIN)  

以下結合動作を比較するにあたり、下記のようなテーブルを使用する  
テーブルA(顧客テーブル)
| 顧客ID | 名前 |
| --- | --- |
| 1 | 田中 |
| 2 | 山田 |
| 3 | 佐藤 |

テーブルB(注文テーブル)
| 注文ID | 顧客ID | 注文商品 |
| --- | --- | --- |
| 101 | 1 | パソコン |
| 102 | 2 | スマホ |
| 104 | 4 | タブレット |

#### INNER JOIN句、内部結合
SELECT * FROM `メインテーブル名`  
INNER JOIN `参照先テーブル` ON `メインテーブル名`.`メイン参照カラム名` = `参照先テーブル`.`参照先カラム名`;  
※ 結合の使うカラムの値がもう一つのテーブルに**存在しない**または**NULL**の場合には、そのレコードを取得しない  
※ **両方のテーブルに存在する**データ**のみ**が結果に含まれる  

使用例：
```MySQL
SELECT A.名前, B.注文商品 FROM テーブルA A
INNER JOIN テーブルB B ON A.顧客ID = B.顧客ID;
```

結果：  
| 名前 | 注文商品 |
| --- | --- |
| 田中 | パソコン |
| 山田 | スマホ |

#### OUTER JOIN句、外部結合
左右は交集の概念
* メインテーブル：左
* 参照先テーブル：右
* 参照先がない場合NULLとなる。内部は該レコードがなかったことになる

##### LEFT OUTER JOIN句、左外部結合
SELECT * FROM `メインテーブル名`  
LEFT OUTER JOIN `参照先テーブル` ON `メインテーブル名`.`メイン参照カラム名` = `参照先テーブル`.`参照先カラム名`;  

使用例：
```MySQL
SELECT A.名前, B.注文商品 FROM テーブルA A
LEFT OUTER JOIN テーブルB B ON A.顧客ID = B.顧客ID;
```

結果：  
| 名前 | 注文商品 |
| --- | --- |
| 田中 | パソコン |
| 山田 | スマホ |
| 佐藤 | NULL |

##### RIGHT OUTER JOIN句、右外部結合
SELECT * FROM `メインテーブル名`  
RIGHT OUTER JOIN `参照先テーブル` ON `メインテーブル名`.`メイン参照カラム名` = `参照先テーブル`.`参照先カラム名`;  

使用例：
```MySQL
SELECT A.名前, B.注文商品 FROM テーブルA A
RIGHT OUTER JOIN テーブルB B ON A.顧客ID = B.顧客ID;
```

結果：  
| 名前 | 注文商品 |
| --- | --- |
| 田中 | パソコン |
| 山田 | スマホ |
| NULL | タブレット |

##### FULL OUTER JOIN句、完全外部結合
SELECT * FROM `メインテーブル名`  
FULL OUTER JOIN `参照先テーブル` ON `メインテーブル名`.`メイン参照カラム名` = `参照先テーブル`.`参照先カラム名`;  

使用例：
```MySQL
SELECT A.名前, B.注文商品 FROM テーブルA A
RIGHT OUTER JOIN テーブルB B ON A.顧客ID = B.顧客ID;
```

結果：  
| 名前 | 注文商品 |
| --- | --- |
| 田中 | パソコン |
| 山田 | スマホ |
| 佐藤 | NULL |
| NULL | タブレット |
